<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.81.0" />
    <meta name="description" content="">


    <link rel="icon" href="../../images/favicon.png" type="image/png">

    <title>1. NoSQL Basics :: Databases</title>

    
    <link href="../../css/nucleus.css?1695632730" rel="stylesheet">
    <link href="../../css/fontawesome-all.min.css?1695632730" rel="stylesheet">
    <link href="../../css/hybrid.css?1695632730" rel="stylesheet">
    <link href="../../css/featherlight.min.css?1695632730" rel="stylesheet">
    <link href="../../css/perfect-scrollbar.min.css?1695632730" rel="stylesheet">
    <link href="../../css/auto-complete.css?1695632730" rel="stylesheet">
    <link href="../../css/atom-one-dark-reasonable.css?1695632730" rel="stylesheet">
    <link href="../../css/theme.css?1695632730" rel="stylesheet">
    <link href="../../css/devselector.css?1695632730" rel="stylesheet">
    <link href="../../css/hugo-theme.css?1695632730" rel="stylesheet">
    <link href="../../css/theme-kul.css?1695632730" rel="stylesheet">
    

    <script src="../../js/jquery-3.3.1.min.js?1695632730"></script>
    <script src="../../js/devselector.js?1695632730"></script>
    <script id="MathJax-script" async
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    
  </head>
  <body class="" data-url="../../nosql/basics/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a href="https://www.kuleuven.be/kuleuven/" target="_blank">
  <img src="../../images/kul.png" alt="KU Leuven" /><br/>
</a>
<a href="https://www.uhasselt.be/" target="_blank">
  <img src="../../images/uhasselt.svg" alt="UHasselt" id="uhlogo" />
</a>
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="../../js/lunr.min.js?1695632730"></script>
<script type="text/javascript" src="../../js/auto-complete.js?1695632730"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/kuleuven-diepenbeek.github.io\/db-course\/";
    
</script>
<script type="text/javascript" src="../../js/search.js?1695632730"></script>

    
  </div>

    <div class="highlightable">

      <h3><a href="../../">Course Contents</a></h3>
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/sql/" title="1. RDBMS" class="dd-item
        
        
        
        ">
      <a href="../../sql/">
          1. RDBMS
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/sql/rdbms-basics/" title="1. Database Basics" class="dd-item ">
        <a href="../../sql/rdbms-basics/">
        1. Database Basics
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/sql/rdbms-components/" title="2. Database Componenten" class="dd-item ">
        <a href="../../sql/rdbms-components/">
        2. Database Componenten
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/sql/rdbms-acid/" title="3. ACID" class="dd-item ">
        <a href="../../sql/rdbms-acid/">
        3. ACID
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/sql-ddl-dml/" title="2. SQL DDL &amp; DML" class="dd-item
        
        
        
        ">
      <a href="../../sql-ddl-dml/">
          2. SQL DDL &amp; DML
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/sql-ddl-dml/ddl/" title="1. DDL" class="dd-item ">
        <a href="../../sql-ddl-dml/ddl/">
        1. DDL
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/sql-ddl-dml/dml/" title="2. DML" class="dd-item ">
        <a href="../../sql-ddl-dml/dml/">
        2. DML
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/transacties/" title="3. RDBMS Transacties" class="dd-item
        
        
        
        ">
      <a href="../../transacties/">
          3. RDBMS Transacties
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/transacties/basics/" title="1. Transaction Mgmt. Basics" class="dd-item ">
        <a href="../../transacties/basics/">
        1. Transaction Mgmt. Basics
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/transacties/concurrency-control/" title="2. Concurrency Control" class="dd-item ">
        <a href="../../transacties/concurrency-control/">
        2. Concurrency Control
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/transacties/failures-rollbacks/" title="3. Failures-Rollbacks" class="dd-item ">
        <a href="../../transacties/failures-rollbacks/">
        3. Failures-Rollbacks
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/transacties/concurrency-in-practice/" title="4. Concurrency in de Praktijk" class="dd-item ">
        <a href="../../transacties/concurrency-in-practice/">
        4. Concurrency in de Praktijk
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/apis/" title="4. Database APIs" class="dd-item
        
        
        
        ">
      <a href="../../apis/">
          4. Database APIs
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/apis/basics/" title="1. API Basics" class="dd-item ">
        <a href="../../apis/basics/">
        1. API Basics
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/apis/jdbc-jdbi/" title="2. JDBC en JDBI" class="dd-item ">
        <a href="../../apis/jdbc-jdbi/">
        2. JDBC en JDBI
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/apis/jpa/" title="3. JPA en Hibernate" class="dd-item ">
        <a href="../../apis/jpa/">
        3. JPA en Hibernate
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/apis/extra-oefeningen/" title="4. Extra Oefeningen" class="dd-item ">
        <a href="../../apis/extra-oefeningen/">
        4. Extra Oefeningen
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/nosql/" title="5. NoSQL" class="dd-item
        parent
        
        
        ">
      <a href="../../nosql/">
          5. NoSQL
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/nosql/basics/" title="1. NoSQL Basics" class="dd-item active">
        <a href="../../nosql/basics/">
        1. NoSQL Basics
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/nosql/keyvaluestores/" title="2. Key-value stores" class="dd-item ">
        <a href="../../nosql/keyvaluestores/">
        2. Key-value stores
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/nosql/documentstores/" title="3. Document stores" class="dd-item ">
        <a href="../../nosql/documentstores/">
        3. Document stores
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/nosql/mapreduce/" title="4. Advanced map-red. queries" class="dd-item ">
        <a href="../../nosql/mapreduce/">
        4. Advanced map-red. queries
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/nosql/replication/" title="5. Replication" class="dd-item ">
        <a href="../../nosql/replication/">
        5. Replication
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/xml/" title="6. XML Data Storage" class="dd-item
        
        
        
        ">
      <a href="../../xml/">
          6. XML Data Storage
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/xml/basics/" title="1. XML Basics" class="dd-item ">
        <a href="../../xml/basics/">
        1. XML Basics
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/xml/xsd/" title="2. XSD" class="dd-item ">
        <a href="../../xml/xsd/">
        2. XSD
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/xml/xpath/" title="3. XPath" class="dd-item ">
        <a href="../../xml/xpath/">
        3. XPath
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/bigdata/" title="7. Big Data &amp; Analytics" class="dd-item
        
        
        
        ">
      <a href="../../bigdata/">
          7. Big Data &amp; Analytics
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/bigdata/basics/" title="1. Big Data Basics" class="dd-item ">
        <a href="../../bigdata/basics/">
        1. Big Data Basics
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/bigdata/datawarehousing/" title="2. Data Warehousing &amp; BI" class="dd-item ">
        <a href="../../bigdata/datawarehousing/">
        2. Data Warehousing &amp; BI
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/extra/" title="X. Extras" class="dd-item
        
        
        
        ">
      <a href="../../extra/">
          X. Extras
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/extra/software/" title="Gebruikte Software" class="dd-item ">
        <a href="../../extra/software/">
        Gebruikte Software
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/extra/project/" title="Project 2023-2024" class="dd-item ">
        <a href="../../extra/project/">
        Project 2023-2024
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://uhintra03.uhasselt.be/studiegidswww/opleidingsonderdeel.aspx?a=2022&amp;i=4290&amp;n=4&amp;t=01"><i class='fa fa-university'></i> ECTS Sheet</a>
              </li>
          
              <li>
                  <a class="padding" href="https://toledo.kuleuven.be/portal/"><i class='fa fa-university'></i> Toledo</a>
              </li>
          
              <li>
                  <a class="padding" href="https://github.com/kuleuven-diepenbeek/db-course/"><i class='fab fa-github'></i> Course Git Repository</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='../../'>Index</a> > <a href='../../nosql/'>5. NoSQL</a> > 1. NoSQL Basics
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#het-schaalbaarheid-probleem">Het schaalbaarheid probleem</a>
      <ul>
        <li><a href="#optie-1-vertical-scaling">Optie 1: Vertical scaling</a></li>
        <li><a href="#optie-2-horizontal-scaling">Optie 2: Horizontal scaling</a></li>
      </ul>
    </li>
    <li><a href="#nosql-basics">NoSQL basics</a>
      <ul>
        <li><a href="#nosql-types">NoSQL Types</a></li>
        <li><a href="#case-studies">Case Studies</a></li>
        <li><a href="#denkvragen">Denkvragen</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              1. NoSQL Basics
            </h1>
          

        


<h2 id="het-schaalbaarheid-probleem">Het schaalbaarheid probleem</h2>
<p>Het probleem met RDMS (<strong>relationele</strong> database management systems) is vaak <em>schaalbaarheid</em>. Gezien de ACID data validity voorwaarden is altijd de vraag: is dit schaalbaar?</p>
<h3 id="optie-1-vertical-scaling">Optie 1: Vertical scaling</h3>
<p>De makkelijke oplossing is &ldquo;scaling up&rdquo;: meer storage, CPU, RAM, &hellip; voorzien zodat er meer cycles kunnen benut worden en hopelijk ook meer transacties concurrent kunnen worden verwerkt (zie <a href="../../transacties/basics">transacties basics</a>).</p>
<p><figure>
	<a href="../../slides/img/moar.jpg" data-featherlight="image">
		<img src="../../slides/img/moar.jpg"  >
	</a>
	
</figure>
</p>
<p>Je botst hier echter snel op <strong>hardware limitaties</strong>&mdash;niet alles is opgelost met een latje RAM.</p>
<h3 id="optie-2-horizontal-scaling">Optie 2: Horizontal scaling</h3>
<p>In plaats van &ldquo;omhoog&rdquo; te gaan en meer hardware in hetzelfde systeem te steken, kunnen we ook meer hardware op verschillende plaatsen in het netwerk zetten: scaling out in <strong>clusters</strong>. Dit noemen we horizontaal scalen: meer kleintjes die gedistribueerd hetzelfde doen.</p>
<p><figure>
	<a href="../../slides/img/cluster.jpg" data-featherlight="image">
		<img src="../../slides/img/cluster.jpg"  >
	</a>
	
</figure>
</p>
<p>Deze oplossing introduceert echter een ander probleem: <em>data consistency</em> is niet altijd gegarandeerd. Als ik iets in één server van een cluster bewaar, wordt dit dan onmiddellijk in de andere ook bewaard? Wat als er eentje uitvalt, en dat net mijn access point was? Op welke manier wordt die data verdeeld binnen de cluster? Enzovoort. <strong>Distributed computing</strong> is een erg complex domein binnen de informatica. We raken in dit vak enkel de top van de ijsberg aan.</p>

<div class="notices note" ><p><em>Wat is een &ldquo;cluster&rdquo; precies?</em><br/><br/> Denk aan een verzameling van grote data centers: twee of meer fysieke centra waar enorm veel servers geplaatst worden. Eén server kan je eigen laptop zijn. Je kan ook verschillende virtuele servers op je laptop draaien: dat is een <em>node</em>. (We hanteren hier de hierarchie van elementen <a href="https://docs.datastax.com/en/home/docs/index.html">volgens Cassandara</a>) <br/><br/><strong>Cluster &laquo; Data Center &laquo; Rack &laquo; Server &laquo; Node</strong></p>
</div>

<p>Een typische relationele database, met zijn ACID eigenschappen, maakt horizontaal schalen dus moeilijk. Consistentie en availability maakt <em>partitioning</em> tot een uitdaging. Dit is ook zichtbaar in het <strong>CAP probleem</strong>; of &ldquo;Consistency, Availability, Partitioning Tolerance&rdquo; probleem. Wil je inzetten op partitioning, dan is de kans groot dat je zal moeten inboeten op consistency en availability. De volgende figuur illustreert dit probleem:</p>
<p><figure>
	<a href="../../slides/img/cap.jpg" data-featherlight="image">
		<img src="../../slides/img/cap.jpg"   title="Het CAP probleem. src: freecodecamp.org">
	</a>
	
		<figcaption>Het CAP probleem. src: freecodecamp.org</figcaption>
	
</figure>
</p>
<p>Flexibiliteit van horizontal scaling krijgen we door af te stappen van een typische RDBMS, en te kijken naar wat er kan als de R (relational) wegvalt&mdash;ofwel <em>noSQL</em> databases. De populariteit hiervan groeide exponentieel sinds scalability een groter probleem werd: denk aan gigantische data warehouses van Amazon, Google&rsquo;s zoek engine, Facebook pagina&rsquo;s, enzovoort. NoSQL systemen garanderen ook consistentie&mdash;alleen niet onmiddellijk: dit heet <strong>eventual consistency</strong>.</p>
<p>Dus, horizontal scaling is eenvoudiger met NoSQL:</p>
<ul>
<li>Er is géén relationele data;</li>
<li>Er is géén (onmiddellijke) consistentie&mdash;dus ook geen coordinatie overhead!;</li>
<li>Dit is zeer goed scalable.</li>
</ul>
<h2 id="nosql-basics">NoSQL basics</h2>
<p>Een vergelijking van eigenschappen tussen een relationele en niet-relationele database systeem:</p>
<table>
<thead>
<tr>
<th>Eigenschap</th>
<th>Relationeel</th>
<th>NoSQL</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Data paradigma</strong></td>
<td>relationeel</td>
<td>4 types: key/val, docs, &hellip; (s3.2)</td>
</tr>
<tr>
<td><strong>Distributie</strong></td>
<td>Single-node</td>
<td>Distributed</td>
</tr>
<tr>
<td><strong>Scalability</strong></td>
<td>Vertical</td>
<td>Horizontal, replication</td>
</tr>
<tr>
<td><strong>Structuur</strong></td>
<td>Schema-based</td>
<td>Flexible</td>
</tr>
<tr>
<td><strong>Querty taal</strong></td>
<td>SQL</td>
<td>Specialized (JavaScript)</td>
</tr>
<tr>
<td><strong>Transacties</strong></td>
<td>ACID</td>
<td>BASE</td>
</tr>
<tr>
<td><strong>Features</strong></td>
<td>views/procs/&hellip;</td>
<td>basic API</td>
</tr>
<tr>
<td><strong>Data vol.</strong></td>
<td>&ldquo;normal&rdquo;</td>
<td>&ldquo;huge amounts&rdquo;</td>
</tr>
</tbody>
</table>
<p>Merk op dat het niet altijd <strong>de beste oplossing</strong> is om naar een NoSQL DB te grijpen. Wanneer dan wel of niet? De volgende vragen kunnen hierbij helpen:</p>
<ul>
<li>Bevat data veel/weinig relaties?</li>
<li>Komt er enorm veel data/sec. binnen?</li>
<li>Replication vereisten?</li>
<li>Scripting mogelijkheden?</li>
<li>Bestaande kennis in bedrijf?</li>
<li>&hellip;</li>
</ul>
<p>Klassieke relationele databases zijn nog steeds een van de meestgebruikte ter wereld, maar dat wil niet zeggen dat er geen (populaire) alternatieven zijn. Kijk eens naar de <a href="https://db-engines.com/en/ranking_trend">db-engines.com ranking trends</a> op db-engines.com:</p>
<p><figure>
	<a href="../../slides/img/ranking.jpg" data-featherlight="image">
		<img src="../../slides/img/ranking.jpg"  >
	</a>
	
</figure>
</p>
<p>De drie bovenste lijnen zijn Oracle, MySQL en Microsoft SQL Server, de drie giganten die alledrie relationele DBMS systemen zijn. PostgresQL, de oranje stijgende lijn, is volgende&mdash;ook SQL. Maar daarnaast volgen MongoDB, Cassandra, Redis, DynamoDB, &hellip;&mdash;allemaal verschillende soorten noSQL alternatieven.</p>
<p>Doe eens een gokje: welk database systeem denk je dar onderstaande websites gebruiken? relationeel of niet-relationeel?</p>
<ul>
<li><a href="https://www.vdab.be/vindeenjob/vacatures">https://www.vdab.be/vindeenjob/vacatures</a></li>
<li><a href="https://www.immoweb.be">https://www.immoweb.be</a></li>
<li><a href="https://twitter.com">https://twitter.com</a> (<a href="https://www.8bitmen.com/what-database-does-twitter-use-a-deep-dive/">hint 1</a>) (<a href="https://blog.twitter.com/engineering/en_us/a/2014/manhattan-our-real-time-multi-tenant-distributed-database-for-twitter-scale">hint 2</a>)</li>
<li><a href="https://people.cs.kuleuven.be/~wouter.groeneveld/courses/">https://people.cs.kuleuven.be/~wouter.groeneveld/courses/</a></li>
<li>Blog websites zoals <a href="https://brainbaking.com/">Brain Baking</a> of <a href="https://diggingthedigital.com/">Digging The Digital</a> (hint: een van beiden is een valstrik)</li>
</ul>
<h3 id="nosql-types">NoSQL Types</h3>
<p><figure>
	<a href="../../slides/img/nosql-types.jpg" data-featherlight="image">
		<img src="../../slides/img/nosql-types.jpg"   title="4 NoSQL types. src: improgrammer.net">
	</a>
	
		<figcaption>4 NoSQL types. src: improgrammer.net</figcaption>
	
</figure>
</p>
<p>Er zijn, zoals bovenstaande figuur aangeeft, 4 grote groepen van NoSQL systemen:</p>
<h4 id="1-document-stores">1. <strong>Document stores</strong>.</h4>
<p>Hier bewaar je een &ldquo;document&rdquo; in, dat meestal in JSON-formaat is, zoals:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#111">{</span>
	<span style="color:#d88200">&#34;bedrag&#34;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">100.3</span><span style="color:#111">,</span>
	<span style="color:#d88200">&#34;gebruiker&#34;</span><span style="color:#f92672">:</span> <span style="color:#d88200">&#34;Jos Klakmans&#34;</span><span style="color:#111">,</span>
	<span style="color:#d88200">&#34;Stad&#34;</span><span style="color:#f92672">:</span> <span style="color:#d88200">&#34;Diepenbeek&#34;</span><span style="color:#111">,</span> 
	<span style="color:#d88200">&#34;certificaten&#34;</span><span style="color:#f92672">:</span> <span style="color:#111">[{</span>
		<span style="color:#d88200">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span><span style="color:#111">,</span>
		<span style="color:#d88200">&#34;naam&#34;</span><span style="color:#f92672">:</span> <span style="color:#d88200">&#34;Master in de bliebloe&#34;</span>
	<span style="color:#111">},</span> <span style="color:#111">{</span>
		<span style="color:#d88200">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">2</span><span style="color:#111">,</span>
		<span style="color:#d88200">&#34;naam&#34;</span><span style="color:#f92672">:</span> <span style="color:#d88200">&#34;Bachelor in de blakkiela&#34;</span>
	<span style="color:#111">}]</span>
<span style="color:#111">}</span>
</code></pre></div><p>Merk op dat hier <em>geen relaties</em> worden gelegd, alhoewel dat wel kan: bijvoorbeeld document 1 kan een property <code>{ id: 1 }</code> hebben, en document 2 <code>{ id: 2, relatedDocumentId: 1 }</code>. Dit echter veel gebruiken zal een performance hit geven: document stores dienen voornamelijk om gigantisch veel onafhankelijke data te bewaren, op een <strong>ongestructureerde</strong> manier. Er zijn een table definities: een key meer of minder maakt niet uit.</p>
<p>NoSQL: <code>{ name: 'Jos' } -&gt; { name: 'Jos', well-behaved: true }</code>. Geen <code>INSERT INTO student(name) VALUES (&quot;Jos&quot;)</code> dus! Ook hier wordt intern <strong>hashing</strong> gebruikt (zie onder): Het document <code>{ name: 'Jos' }</code> wordt intern opgeslaan als <code>{ name: 'Jos', _id: 23235435 }</code>. Data retrieval snelheid blijft belangrijk, dus extra indexen/views kunnen door de gebruiker zelf worden aangemaakt (zie volgende hoofdstukken).</p>
<p>Om documenten te ordenen worden soms wel <strong>collecties</strong> aangemaakt, maar dit is bijna altijd <em>optioneel</em>!</p>
<p>We zullen ons in deze cursus focussen op document stores. Zie <a href="../../nosql/documentstores">NoSQL - document stores</a> om een idee te hebben hoe dit in de praktijk gebruikt wordt.</p>
<h4 id="2-graph-based-oplossingen">2. <strong>Graph-based</strong> oplossingen.</h4>
<p>Wat als we toch veel <strong>relationele gegevens</strong> hebben, maar het nog steeds over (1) ongestructureerde data gaat en (2) te veel is voor in één klassiek RDBMS systeem te bewaren? Als de <strong>relaties de data zelf zijn</strong>, dan hebben we een grafen-gebaseerde oplossing nodig. Hier zijn géén dure <code>JOIN</code> statements nodig om de relaties ad-hoc te maken. Een typische toepassing hiervan zou social graphs zijn.</p>
<p><figure>
	<a href="../../slides/img/neo4j.jpg" data-featherlight="image">
		<img src="../../slides/img/neo4j.jpg"   title="Een voorbeeld subgraph visualisatie in Neo4j.">
	</a>
	
		<figcaption>Een voorbeeld subgraph visualisatie in Neo4j.</figcaption>
	
</figure>
</p>
<p>Stel dat je alle boeken wilt ophalen geschreven door een bepaalde auteur (= de relatie). In SQL, waar de data typisch in twee tabellen leeft (<code>book</code> en <code>author</code>), heb je een (impliciete) <code>JOIN</code> nodig:</p>
<pre><code>SELECT book, title FROM book, author, books_authors
WHERE author.id = books_authors.author_id
AND book.id = books_authors.book_id
AND author.name = &quot;De Jos&quot;
</code></pre><p>Maar in <strong>Cypher</strong>, de querytaal van grafendatabase <a href="https://neo4j.com/">Neo4J</a>, ziet die query er als volgt uit:</p>
<pre><code>MATCH (b:Book) &lt;- [ :WRITTEN_BY]-(a:Author)
WHERE a.name = &quot;De Jos&quot;
RETURN b.title
</code></pre><p>Data wordt op basis van <code>WRITTEN_BY</code> relatie eigenschap opgehaald. Relationele data&mdash;de letterlijke <em>relaties</em>&mdash;zijn hier altijd <strong>expliciet</strong>, en niet verborgen in foreign key constraints.</p>
<h4 id="3-key-value-stores">3. <strong>Key-Value stores</strong>.</h4>
<p>Dit is de eenvoudigste soort, waarbij gewoon blobs van data in een hash table opgeslagen worden, zoals jullie gewoon zijn in Java:</p>
<div class="devselect">
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#111">Map</span><span style="color:#f92672">&lt;</span><span style="color:#111">String</span><span style="color:#f92672">,</span> <span style="color:#111">Persoon</span><span style="color:#f92672">&gt;</span> <span style="color:#111">leeftijden</span> <span style="color:#f92672">=</span> <span style="color:#00a8c8">new</span> <span style="color:#111">HashMap</span><span style="color:#f92672">&lt;&gt;();</span>
<span style="color:#111">leeftijden</span><span style="color:#f92672">.</span><span style="color:#75af00">put</span><span style="color:#f92672">(</span><span style="color:#d88200">&#34;Wilfried&#34;</span><span style="color:#f92672">,</span> <span style="color:#00a8c8">new</span> <span style="color:#111">Persoon</span><span style="color:#f92672">(</span><span style="color:#d88200">&#34;Wilfried&#34;</span><span style="color:#f92672">,</span> <span style="color:#111">20</span><span style="color:#f92672">));</span>
<span style="color:#111">leeftijden</span><span style="color:#f92672">.</span><span style="color:#75af00">put</span><span style="color:#f92672">(</span><span style="color:#d88200">&#34;Seppe&#34;</span><span style="color:#f92672">,</span> <span style="color:#00a8c8">new</span> <span style="color:#111">Persoon</span><span style="color:#f92672">(</span><span style="color:#d88200">&#34;Seppe&#34;</span><span style="color:#f92672">,</span> <span style="color:#111">30</span><span style="color:#f92672">));</span>
<span style="color:#111">leeftijden</span><span style="color:#f92672">.</span><span style="color:#75af00">put</span><span style="color:#f92672">(</span><span style="color:#d88200">&#34;Bart&#34;</span><span style="color:#f92672">,</span> <span style="color:#00a8c8">new</span> <span style="color:#111">Persoon</span><span style="color:#f92672">(</span><span style="color:#d88200">&#34;Bart&#34;</span><span style="color:#f92672">,</span> <span style="color:#111">40</span><span style="color:#f92672">));</span>
<span style="color:#111">leeftijden</span><span style="color:#f92672">.</span><span style="color:#75af00">put</span><span style="color:#f92672">(</span><span style="color:#d88200">&#34;Jeanne&#34;</span><span style="color:#f92672">,</span> <span style="color:#00a8c8">new</span> <span style="color:#111">Persoon</span><span style="color:#f92672">(</span><span style="color:#d88200">&#34;Jeanne&#34;</span><span style="color:#f92672">,</span> <span style="color:#111">18</span><span style="color:#f92672">));</span>
</code></pre></div><div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#00a8c8">var</span> <span style="color:#111">leeftijden</span> <span style="color:#111">=</span> <span style="color:#111">hashMapOf</span><span style="color:#111">(</span>
	<span style="color:#d88200">&#34;Wilfried&#34;</span> <span style="color:#111">to</span> <span style="color:#111">Persoon</span><span style="color:#111">(</span><span style="color:#d88200">&#34;Wilfried&#34;</span><span style="color:#111">,</span> <span style="color:#ae81ff">20</span><span style="color:#111">),</span>
	<span style="color:#d88200">&#34;Seppe&#34;</span> <span style="color:#111">to</span> <span style="color:#111">Persoon</span><span style="color:#111">(</span><span style="color:#d88200">&#34;Jaqueline&#34;</span><span style="color:#111">,</span> <span style="color:#ae81ff">30</span><span style="color:#111">),</span>
	<span style="color:#d88200">&#34;Bart&#34;</span> <span style="color:#111">to</span> <span style="color:#111">Persoon</span><span style="color:#111">(</span><span style="color:#d88200">&#34;Bart&#34;</span><span style="color:#111">,</span> <span style="color:#ae81ff">40</span><span style="color:#111">),</span>
	<span style="color:#d88200">&#34;Jeanne&#34;</span> <span style="color:#111">to</span> <span style="color:#111">Persoon</span><span style="color:#111">(</span><span style="color:#d88200">&#34;Jeanne&#34;</span><span style="color:#111">,</span> <span style="color:#ae81ff">18</span><span style="color:#111">))</span>
</code></pre></div></div>
<h5 id="hash-functies">Hash functies</h5>
<p>In dit voorbeeld stopt de <code>HashMap</code> met bestaan zodra die out of scope gaat op je eigen machine, maar er zijn ook <strong>distributed hash tables</strong>. Hier is de <strong>hash functie</strong> het belangrijkste onderdeel, die de onderliggende key genereerd en dus bepaald in welke &ldquo;bucket&rdquo; een waarde wordt opgeslagen&mdash;en dus ook, op welke server in een cluster. Een goede hash functie moet (1) deterministisch zijn: atlijd dezelfde hash waarde voor dezelfe input genereren; (2) uniform zijn: er moet een goede verdeling zijn van de output range; en (3) een vaste grootte hebben zodat het makkelijker is voor de data structuur om de hash waarde te bewaren.</p>
<p><figure>
	<a href="../../img/hashing.png" data-featherlight="image">
		<img src="../../img/hashing.png"  >
	</a>
	
</figure>
</p>
<p>Vrijwel alle NoSQL databases gebruiken achterliggend hashing technieken om <strong>horizontal scalability</strong> makkelijker te maken. Als alle hash values mooi verdeeld worden, kan dit ook mooi over verschillende databases verdeeld worden.</p>
<p><figure>
	<a href="../../img/hashing2.png" data-featherlight="image">
		<img src="../../img/hashing2.png"  >
	</a>
	
</figure>
</p>
<h5 id="paritioningsharding">Paritioning/sharding</h5>
<p>In bovenstaand voorbeeld worden de persoonsgegevens verspreid over 3 verschillende servers door de hashing &ldquo;index&rdquo; (mod3 + 1). Data partitioning noemen we ook wel <strong>sharding</strong> waarbij een individuele partitie een <strong>shard</strong> is. Om zo <em>efficient mogelijk</em> te partitioneren schakel je best servers aan elkaar in een soort van &ldquo;ring&rdquo;, zoals in dit schema:</p>
<p><figure>
	<a href="../../slides/img/swift.png" data-featherlight="image">
		<img src="../../slides/img/swift.png"  >
	</a>
	
</figure>
</p>
<p>Ring partitioning vereist wel consistent hashing functies, anders klopt de node verdeling (de kleuren in het schema) niet meer. Om zo effient mogelijk data door te geven (<strong>replication</strong>, zie later <a href="../../nosql/replication">NoSQL: replication</a>) hebben nodes weet van elkaar. Het is echter nog steeds niet mogelijk om de ACID regels te volgen: een gedistribueerd systeem zoals deze ring kan nooit én consistent én available én partition tolerant zijn.</p>
<p>Wat is dan een oplossing voor NoSQL systemen? <strong>BASE</strong> in plaats van ACID:</p>
<ul>
<li><strong>Basically Available</strong> (BA); elke (gebruikelijk HTTP-based) request ontvangt een respons, hetzij een <code>200</code> (OK), hetzij een <code>4xx</code>/<code>5xx</code> (een externe/interne fout). Ook al zijn niet alle nodes geupdate, toch kan er al een <code>201</code> worden teruggegeven&mdash;asynchroon dus.</li>
<li><strong>Soft state</strong> (S); sate kan wijzigen, ook zonder input! We weten dus nooit exact wat er in de shards zit. Read requests zijn soms out-of-date omdat een shard update in de ring partitie plaats aan het vinden was, maar dat één bepaalde shard nog niet bereikte&hellip;</li>
<li><strong>Eventually Consistent</strong> (E); NoSQL biedt de &ldquo;ooit is het zel consistent&rdquo; mode aan.</li>
</ul>
<p>In de praktijk verschilt het van NoSQL database tot database systeem hoe dicht deze BASE regels tegen de ACID regels aanleunen. De document-based CouchDB, die we later zullen in detail bekijken, ondersteunt ook vormen van transacties en dergelijke, wat het eerder iets ACID-achtig maakt.</p>
<h5 id="memcached">Memcached</h5>
<p>Memcache<strong>d</strong> is een <strong>d</strong>istributed in-memory key/value store die op grote schaal gebruikt kan worden als caching mechanisme. Systemen als Memcached zijn <strong>enorm performant</strong> en worden vaak gebruikt als <strong>caching database</strong> die geplaatst wordt voor de eigenlijke RDBMS:</p>

<div class="mermaid" align="left" >
	
graph LR;
    user[User]
    cache{Cache DB}
    db{Relationele DB}
    user -->|Haal genres op| cache
    cache -->|cache hit| user 
    cache -->|cache miss| db
    db -->|refresh| cache

</div>
<p>Het feit dat <em>Netflix</em> Memcached sponsort zegt genoeg. Memcached gebruiken is erg eenvoudig en gewoon een kwestie van de API in Java/Kotlin aan te spreken om data te feeden/op te halen.</p>
<p>Een simpel Memcached voorbeeld is terug te vinden onder <a href="../../nosql/keyvaluestores/#12-distributed-hashmaps-memcached">key-value stores: memcached</a>.</p>
<h4 id="4-wide-column-databases">4. <strong>Wide-column</strong> databases.</h4>
<p>Wide-column, of <strong>column-based</strong> databases, zijn eigenlijk relationele databases op zijn kop&mdash;letterlijk.</p>
<p>Wat is het grootste nadeel van het queryen van relationele databases? Deze zijn <strong>row-based</strong>: als je alle genres uit een <code>BOEK</code> tabel wilt halen, zal je alle rijen moeten afgaan en daar een <code>DISTINCT</code> op doen&mdash;alles behalve performant. Bijvoorbeeld:</p>
<pre><code>id genre title price
1 Fantasy book bla 10
2 Fantasy another title 20
3 horror wow-book 10
</code></pre><p>Hoe haal ik hier alle genres op? <code>SELECT DISTINCT(genre) FROM boeken</code>.  Wat is de gemiddelde prijs? <code>SELECT AVG(price) FROM boeken</code>&mdash;ook een erg dure operatie indien er miljoenen records aanwezig zijn. Een snelheidswinst valt te boeken door te werken met <strong>indexen</strong>, maar daar lossen we niet alles mee op.</p>
<p>Wat nu als je de kolommen als rijen beschouwt, op deze manier:</p>
<pre><code>genre: fantasy:1,2     horror: 3
title: book bla:1, another title:2 wow-book: 3
price: 10:1,3    20:2
</code></pre><p>Wat is nu de gemiddelde prijs? Haal 1 &ldquo;rij&rdquo; op en deel door het aantal. Welke genres zijn er zoal? De eerste rij is al onmiddellijk het antwoord! We verzamelen hier dus <strong>vertical slices</strong> van data, wat erg belangrijk kan zijn voor <strong>Business Intelligence</strong> (BI): super-linked data tussen de &ldquo;echte&rdquo; row-based data.</p>
<p>De meest gebruikte column-DB is <a href="https://cassandra.apache.org/_/index.html">Cassandra</a>. Op de website staat:</p>
<blockquote>
<p>Manage massive amounts of data, fast, without losing sleep.</p>
</blockquote>
<p>Cassandra komt met in-memory buffers, tracking &amp; monitoring, &hellip;</p>
<h3 id="case-studies">Case Studies</h3>
<p>Welke database systemen&mdash;of een combinatie ervan&mdash;denk je dat de volgende grote bedrijven hanteren voor hun producten?</p>
<p><figure>
	<a href="../../slides/img/ebay.png" data-featherlight="image">
		<img src="../../slides/img/ebay.png"  >
	</a>
	
</figure>
</p>
<ul>
<li><a href="https://www.benl.ebay.be/">https://www.benl.ebay.be/</a></li>
<li>Hint: <a href="https://www.slideshare.net/jaykumarpatel/cassandra-at-ebay-13920376">https://www.slideshare.net/jaykumarpatel/cassandra-at-ebay-13920376</a> (2012)</li>
</ul>
<p><figure>
	<a href="../../slides/img/usarmy.png" data-featherlight="image">
		<img src="../../slides/img/usarmy.png"  >
	</a>
	
</figure>
</p>
<ul>
<li><a href="https://www.army.mil/">https://www.army.mil/</a></li>
<li>Hint: <a href="https://go.neo4j.com/rs/710-RRC-335/images/Neo4j-case-study-US-army-EN-US.pdf">https://go.neo4j.com/rs/710-RRC-335/images/Neo4j-case-study-US-army-EN-US.pdf</a> (2019)</li>
</ul>
<p><figure>
	<a href="../../slides/img/spotify.png" data-featherlight="image">
		<img src="../../slides/img/spotify.png"  >
	</a>
	
</figure>
</p>
<ul>
<li><a href="https://spotify.com/">https://spotify.com/</a></li>
<li>Hint: <a href="https://engineering.atspotify.com/2015/01/09/personalization-at-spotify-using-cassandra/">https://engineering.atspotify.com/2015/01/09/personalization-at-spotify-using-cassandra/</a> (2015)</li>
</ul>
<p><figure>
	<a href="../../slides/img/uber.png" data-featherlight="image">
		<img src="../../slides/img/uber.png"  >
	</a>
	
</figure>
</p>
<ul>
<li><a href="https://uber.com/">https://uber.com/</a></li>
<li>Hint: <a href="http://highscalability.com/blog/2016/9/28/how-uber-manages-a-million-writes-per-second-using-mesos-and.html">http://highscalability.com/blog/2016/9/28/how-uber-manages-a-million-writes-per-second-using-mesos-and.html</a> (2016)</li>
</ul>
<h3 id="denkvragen">Denkvragen</h3>
<ul>
<li>Is een RDBMS of een NoSQL database geschikter om aan &ldquo;Big Data&rdquo; te doen? Waarom wel/niet?</li>
<li>Waarom vereist ring partitioning consistent hashing?</li>
<li>Wat heeft een hashing functie te maken met het horizontaal kunnen schalen van data in een DBMS?</li>
<li>Waarom gebruiken zo veel grote bedrijven een combinatie van verschillende DBMS systemen? Zie je hier ook nadelen in?</li>
<li>Wanneer denk je dat een column-based database als Cassandra nuttig zou zijn?</li>
<li>Leg het verschil tussen ACID en BASE uit in functie van de typische eigenschappen van een database.</li>
<li>Waarom werkt vertical scaling niet? Waarom wel?</li>
</ul>


<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="../../nosql/" title="5. NoSQL"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="../../nosql/keyvaluestores/" title="2. Key-value stores" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="../../js/clipboard.min.js?1695632730"></script>
    <script src="../../js/perfect-scrollbar.min.js?1695632730"></script>
    <script src="../../js/perfect-scrollbar.jquery.min.js?1695632730"></script>
    <script src="../../js/jquery.sticky.js?1695632730"></script>
    <script src="../../js/featherlight.min.js?1695632730"></script>
    <script src="../../js/modernizr.custom-3.6.0.js?1695632730"></script>
    <script src="../../js/learn.js?1695632730"></script>
    <script src="../../js/hugo-learn.js?1695632730"></script>
    <script src="../../js/mermaid.min.js?1695632730"></script>
    <script>
    window.MathJax = {
      chtml: {
        scale: 2,                      
        minScale: .5,                  
        matchFontHeight: true,         
        mtextInheritFont: false,       
        merrorInheritFont: true,       
        mathmlSpacing: false,          
        skipAttributes: {},            
        exFactor: .5,                  
        displayAlign: 'center',        
        displayIndent: '0'             
      }
    };
    </script>
    
    

  </body>
</html>

